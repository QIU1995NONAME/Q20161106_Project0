# 单片机串口命令
这个文件只是为了记述上位机与下位机串口指令代码以及其含义。    
接下来的标题格式为    
** <功能码> : 功能 **
## 0x7? 系列
### 0x77 心跳
上位机->下位机: 没有参数，代表启动并维持心跳。    
下位机->上位机:     
* 4个字节的时间戳秒数(低字节到高字节)
* 若干字节的状态值 _目前预留4字节_。每个字节最高位(Bit _7_)为0_(1代表本字节无效)_。没有注明的为预留。
    + 状态字节0:
      + Bit _6_ SD 卡是否可用.
      + Bit _5_ 底层采样是否正在进行.
      + Bit _4_ 串口采样是否正在进行.
    + 状态字节1: 
    + 状态字节2: 
    + 状态字节3: 
    
首先由上位机给下位机发送一个心跳请求，然后下位机每秒回应一次。
每次下位机回应的时候上位机应当再次发送一个请求。
如果上位机在接下来下位机回应6次的过程中没有回应，则连接断开，同时所有的定时发送功能全部停止。
在断开的情况下下位机只会响应上位机发送的心跳指令。

### 0x78 时间同步
上位机->下位机：一个参数，4字节，代表当前的秒。

此命令为单方向的，只由上位机向下位机发送以秒为精度的时间戳。下位机更新时间戳，不返回。
如果参数的长度不足4字节，则忽略这个命令

## 0x6? 系列
### 0x60 底层采样功能停止
上位机->下位机：没有参数。

### 0x61 底层采样功能启动
上位机->下位机：没有参数。

### 0x68 串口采样功能停止
上位机->下位机：没有参数。   
_如果底层采样没有启动，或者心跳停止，则自动切换到此模式。_

### 0x69 串口采样功能启动
上位机->下位机：没有参数。
下位机->上位机：定时返回一个带有一个16字节的采样值。

## 0x5? 系列
### 0x50 控制模块获取状态
上位机->下位机：无参数    
下位机->上位机：
* Byte 0 工程编号
* Byte 1 模式编号


### 0x51 设置控制模块当前工程
上位机->下位机：一个参数，有符号char，设置工程

### 0x52 设置控制模块当前模式
上位机->下位机：一个参数，有符号char，设置模式

### 0x53 Reserved

### 0x54 获取控制模块某一个double值
上位机->下位机：1字节index       
下位机->上位机：1字节index, 8字节double value

### 0x55 设置控制模块某一个double值
上位机->下位机：1字节index 8字节double value

### 0x56 获取控制模块某一个int值
上位机->下位机：1字节index     
下位机->上位机：1字节index, 4字节int value

### 0x57 设定控制模块某一个int值
上位机->下位机：1字节index, 4字节int_value
